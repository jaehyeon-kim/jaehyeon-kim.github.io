<!doctype html><html class=position-relative itemscope itemtype=http://schema.org/WebPage lang=en data-bs-theme=light data-palette=blue-gray><head><script src=/assets/init/bundle.min.75fc37559b43c1a1031e6683d5ec9e833130be1398e4332f364273c68c9037d0.js integrity="sha256-dfw3VZtDwaEDHmaD1eyegzEwvhOY5DMvNkJzxoyQN9A=" crossorigin=anonymous></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Data Lake Demo using Change Data Capture (CDC) on AWS – Part 3 Implement Data Lake - Jaehyeon Kim</title><link rel=icon href=/favicon_huf63427acbec4fbe11db6a32164cc2763_6040_16x16_resize_q75_h2_box_2.webp sizes=16x16 type=image/webp><link rel=icon href=/favicon_huf63427acbec4fbe11db6a32164cc2763_6040_32x32_resize_q75_h2_box_2.webp sizes=32x32 type=image/webp><link rel=icon href=/favicon_huf63427acbec4fbe11db6a32164cc2763_6040_150x150_resize_q75_h2_box_2.webp sizes=150x150 type=image/webp><link rel=apple-touch-icon href=/favicon_huf63427acbec4fbe11db6a32164cc2763_6040_180x180_resize_q75_h2_box_2.webp sizes=180x180 type=image/webp><link rel=icon href=/favicon_huf63427acbec4fbe11db6a32164cc2763_6040_192x192_resize_q75_h2_box_2.webp sizes=192x192 type=image/webp><link rel=mask-icon href=/safari-pinned-tab.svg color=#6f42c1><meta name=keywords content="AWS,Data,Analytics,Containers,Serverless"><meta name=description content="Change data capture (CDC) on Amazon MSK and ingesting data using Apache Hudi on Amazon EMR can be used to build an efficient data lake solution. In this post, we'll build a Hudi DeltaStramer app on Amazon EMR and use the resulting Hudi table with Athena and Quicksight to build a dashboard."><meta name=robots content="index, follow"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://jaehyeon.me/blog/2021-12-19-datalake-demo-part3/featured.png"><meta name=twitter:title content="Data Lake Demo using Change Data Capture (CDC) on AWS – Part 3 Implement Data Lake"><meta name=twitter:description content="Change data capture (CDC) on Amazon MSK and ingesting data using Apache Hudi on Amazon EMR can be used to build an efficient data lake solution. In this post, we'll build a Hudi DeltaStramer app on Amazon EMR and use the resulting Hudi table with Athena and Quicksight to build a dashboard."><meta property="og:title" content="Data Lake Demo using Change Data Capture (CDC) on AWS – Part 3 Implement Data Lake"><meta property="og:description" content="Change data capture (CDC) on Amazon MSK and ingesting data using Apache Hudi on Amazon EMR can be used to build an efficient data lake solution. In this post, we'll build a Hudi DeltaStramer app on Amazon EMR and use the resulting Hudi table with Athena and Quicksight to build a dashboard."><meta property="og:type" content="article"><meta property="og:url" content="https://jaehyeon.me/blog/2021-12-19-datalake-demo-part3/"><meta property="og:image" content="https://jaehyeon.me/blog/2021-12-19-datalake-demo-part3/featured.png"><meta property="article:section" content="blog"><meta property="article:published_time" content="2021-12-19T00:00:00+00:00"><meta property="article:modified_time" content="2023-05-04T09:22:05+10:00"><meta property="og:see_also" content="https://jaehyeon.me/blog/2021-12-12-datalake-demo-part2/"><meta property="og:see_also" content="https://jaehyeon.me/blog/2021-12-05-datalake-demo-part1/"><meta itemprop=name content="Data Lake Demo using Change Data Capture (CDC) on AWS – Part 3 Implement Data Lake"><meta itemprop=description content="Change data capture (CDC) on Amazon MSK and ingesting data using Apache Hudi on Amazon EMR can be used to build an efficient data lake solution. In this post, we'll build a Hudi DeltaStramer app on Amazon EMR and use the resulting Hudi table with Athena and Quicksight to build a dashboard."><meta itemprop=datePublished content="2021-12-19T00:00:00+00:00"><meta itemprop=dateModified content="2023-05-04T09:22:05+10:00"><meta itemprop=wordCount content="2316"><meta itemprop=image content="https://jaehyeon.me/blog/2021-12-19-datalake-demo-part3/featured.png"><meta itemprop=keywords content="AWS,Amazon EMR,Amazon MSK,Amazon MSK Connect,Apache Spark,Apache Hudi,Apache Kafka,Change Data Capture,Data Lake,Docker,Terraform,"><link rel=manifest href=/manifest.json><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2764466088407958"></script>
<link data-precache rel=stylesheet href="/assets/main/bundle.min.76ed053a00b5cbfb699d7f01a609bc3d36f09840ef420d5d1d53618d49a8c0ea.css" integrity="sha256-du0FOgC1y/tpnX8Bpgm8PTbwmEDvQg1dHVNhjUmowOo=" crossorigin=anonymous><link data-precache rel=stylesheet href=/assets/katex/bundle.min.222aac0b0b2e29944e5e468ecbd302b4ece09ac5ee29a0c811086b03659edd76.css integrity="sha256-IiqsCwsuKZROXkaOy9MCtOzgmsXuKaDIEQhrA2We3XY=" crossorigin=anonymous><link data-precache rel=stylesheet href=/assets/viewer/bundle.min.eb914844636cd41f221f109e99c887bbc3b6b5ffb2af7c664b284cea2d1b54b7.css integrity="sha256-65FIRGNs1B8iHxCemciHu8O2tf+yr3xmSyhM6i0bVLc=" crossorigin=anonymous></head><body><header><nav class="top-app-bar shadow navbar navbar-expand-xxl fixed-top"><div class=container><a class="navbar-brand d-flex align-items-center flex-grow-1 flex-xxl-grow-0 justify-content-xxl-start ms-2 ms-xxl-0 mx-auto me-xxl-2" href=https://jaehyeon.me/>Jaehyeon Kim</a><div class="offcanvas-xxl offcanvas-end flex-grow-1" data-bs-scroll=true tabindex=-1 id=navbarMenus aria-labelledby=navbarMenusLabel><div class="offcanvas-header px-4 pb-0"><div class="offcanvas-title h5" id=navbarMenusLabel>Jaehyeon Kim</div><button type=button class="btn-close btn-close-white" data-bs-dismiss=offcanvas data-bs-target=#navbarMenus aria-label=Close></button></div><div class="offcanvas-body p-4 pt-0 p-xxl-0"><hr class=d-xxl-none><ul class="navbar-nav flex-row flex-wrap align-items-center me-auto"><li class="nav-item col-12 col-xxl-auto dropdown px-0"><a href=# class="nav-link dropdown-toggle" id=navbarDropdownBlog role=button data-bs-toggle=dropdown aria-expanded=false><span class="menu-icon me-1"><i class="fas fa-fw fa-blog text-warning"></i></span>Blog</a><ul class="dropdown-menu dropdown-menu-end" aria-labelledby=navbarDropdownBlog data-bs-popper=none><li><a class="dropdown-item d-flex align-items-center text-wrap text-xxl-nowrap" href=https://jaehyeon.me/archives/><span class="dropdown-item-icon me-2 p-2 rounded"><i class="fas fa-fw fa-file-archive text-primary"></i></span><div class=dropdown-item-content><p class="dropdown-item-title mb-0">Archives</p></div></a></li><li><a class="dropdown-item d-flex align-items-center text-wrap text-xxl-nowrap" href=https://jaehyeon.me/series/><span class="dropdown-item-icon me-2 p-2 rounded"><i class="fas fa-fw fa-columns"></i></span><div class=dropdown-item-content><p class="dropdown-item-title mb-1">Series</p><p class="dropdown-item-description mb-0 text-secondary">List of series.</p></div></a></li><li><a class="dropdown-item d-flex align-items-center text-wrap text-xxl-nowrap" href=https://jaehyeon.me/categories/><span class="dropdown-item-icon me-2 p-2 rounded"><i class="fas fa-fw fa-folder text-success"></i></span><div class=dropdown-item-content><p class="dropdown-item-title mb-1">Categories</p><p class="dropdown-item-description mb-0 text-secondary">List of categories.</p></div></a></li><li><a class="dropdown-item d-flex align-items-center text-wrap text-xxl-nowrap" href=https://jaehyeon.me/tags/><span class="dropdown-item-icon me-2 p-2 rounded"><i class="fas fa-fw fa-tags"></i></span><div class=dropdown-item-content><p class="dropdown-item-title mb-1">Tags</p><p class="dropdown-item-description mb-0 text-secondary">List of tags.</p></div></a></li></ul></li></ul><hr class=d-xxl-none><form class="search-bar ms-auto my-1" action=/search/ novalidate><div class="input-group input-group-sm align-items-center"><span class="btn btn-search disabled position-absolute left-0 border-0 px-1"><i class="fas fa-fw fa-search fa-lg"></i></span>
<input class="my-1 form-control border-white rounded search-input bg-body" name=q type=search placeholder="Press / to search" aria-label=Search required></div></form><hr class=d-xxl-none><ul class="navbar-nav flex-row flex-wrap align-items-center ms-md-auto"><li class="nav-item py-2 py-xxl-1 col-12 col-xxl-auto"><nav class="social-links nav justify-content-center flex-row"><a class="nav-link social-link col-6 col-xxl-auto p-1" target=_blank href=https://github.com/jaehyeon-kim title=GitHub rel=me><i class="fa-fw fab fa-github"></i>
<span class="ms-1 d-xxl-none">Github</span></a>
<a class="nav-link social-link col-6 col-xxl-auto p-1" target=_blank href=https://linkedin.com/in/jaehyeon-kim-76b93429 title=LinkedIn rel=me><i class="fa-fw fab fa-linkedin-in"></i>
<span class="ms-1 d-xxl-none">Linkedin</span></a>
<a class="nav-link social-link col-6 col-xxl-auto p-1" target=_blank href=https://www.paypal.com/paypalme/dottami title=PayPal rel=me><i class="fa-fw fab fa-paypal"></i>
<span class="ms-1 d-xxl-none">Paypal</span></a>
<a class="nav-link social-link col-6 col-xxl-auto p-1" target=_blank href=/index.xml title=RSS rel=me><i class="fas fa-fw fa-rss"></i>
<span class="ms-1 d-xxl-none">RSS</span></a></nav></li><li class="nav-item py-2 py-xxl-1 col-12 col-xxl-auto"><div class="vr d-none d-xxl-flex h-100 mx-xxl-2 text-white"></div><hr class="d-xxl-none my-2"></li><li class="nav-item dropdown col-6 col-xxl-auto"><a class="nav-link px-0 py-2 px-xxl-1" href=# id=fontSizeDropdown role=button data-bs-toggle=dropdown aria-expanded=false><i class="fas fa-fw fa-font"></i>
<span class=d-xxl-none>Font Size</span></a><ul class="dropdown-menu dropdown-menu-end" aria-labelledby=fontSizeDropdown><li><button class="font-size-item dropdown-item" data-size=xs>
Extra Small</button></li><li><button class="font-size-item dropdown-item" data-size=sm>
Small</button></li><li><button class="font-size-item dropdown-item active" data-size=md>
Medium</button></li><li><button class="font-size-item dropdown-item" data-size=lg>
Large</button></li><li><button class="font-size-item dropdown-item" data-size=xl>
Extra Large</button></li></ul></li><li class="nav-item dropdown col-6 col-xxl-auto"><a class="nav-link px-0 py-2 px-xxl-1" href=# id=paletteDropdown role=button data-bs-toggle=dropdown aria-expanded=false><i class="fas fa-fw fa-palette"></i>
<span class=d-xxl-none>Palette</span></a><ul class="palette-dropdown-menu dropdown-menu dropdown-menu-end px-2 row g-2" aria-labelledby=paletteDropdown><li class="col-4 my-1"><a role=button id=palette-blue aria-label=Blue class="btn btn-sm w-100 palette text-bg-blue" data-palette=blue></a></li><li class="col-4 my-1"><a role=button id=palette-blue-gray aria-label="Blue Gray" class="btn btn-sm w-100 palette text-bg-blue-gray" data-palette=blue-gray></a></li><li class="col-4 my-1"><a role=button id=palette-brown aria-label=Brown class="btn btn-sm w-100 palette text-bg-brown" data-palette=brown></a></li><li class="col-4 my-1"><a role=button id=palette-cyan aria-label=Cyan class="btn btn-sm w-100 palette text-bg-cyan" data-palette=cyan></a></li><li class="col-4 my-1"><a role=button id=palette-green aria-label=Green class="btn btn-sm w-100 palette text-bg-green" data-palette=green></a></li><li class="col-4 my-1"><a role=button id=palette-indigo aria-label=Indigo class="btn btn-sm w-100 palette text-bg-indigo" data-palette=indigo></a></li><li class="col-4 my-1"><a role=button id=palette-orange aria-label=Orange class="btn btn-sm w-100 palette text-bg-orange" data-palette=orange></a></li><li class="col-4 my-1"><a role=button id=palette-pink aria-label=Pink class="btn btn-sm w-100 palette text-bg-pink" data-palette=pink></a></li><li class="col-4 my-1"><a role=button id=palette-purple aria-label=Purple class="btn btn-sm w-100 palette text-bg-purple" data-palette=purple></a></li><li class="col-4 my-1"><a role=button id=palette-red aria-label=Red class="btn btn-sm w-100 palette text-bg-red" data-palette=red></a></li><li class="col-4 my-1"><a role=button id=palette-teal aria-label=Teal class="btn btn-sm w-100 palette text-bg-teal" data-palette=teal></a></li><li class="col-4 my-1"><a role=button id=palette-yellow aria-label=Yellow class="btn btn-sm w-100 palette text-bg-yellow" data-palette=yellow></a></li></ul></li><li class="nav-item dropdown col-6 col-xxl-auto"><a class="nav-link px-0 py-2 px-xxl-1" href=# id=modeDropdown role=button data-bs-toggle=dropdown aria-expanded=false><i class="mode-icon fas fa-fw fa-sun" id=modeIcon></i>
<span class=d-xxl-none>Mode</span></a><ul class="dropdown-menu dropdown-menu-end" aria-labelledby=modeDropdown><li class="mode-item active" data-color-mode=light data-icon=sun><button class=dropdown-item>
<i class="mode-icon fas fa-fw fa-sun"></i> Light</button></li><li class=mode-item data-color-mode=dark data-icon=moon><button class=dropdown-item>
<i class="mode-icon fas fa-fw fa-moon"></i> Dark</button></li><li class=mode-item data-color-mode=auto data-icon=adjust><button class=dropdown-item>
<i class="mode-icon fas fa-fw fa-adjust"></i> Auto</button></li></ul></li></ul></div></div><div class=d-flex><button class="navbar-toggler order-5 border-0" type=button data-bs-toggle=offcanvas data-bs-target=#navbarMenus aria-controls=navbarMenus aria-expanded=false aria-label="Toggle navigation">
<i class="fas fa-ellipsis-h"></i></button></div></div></nav></header><main class=container><div class="row content"><noscript><div class="alert alert-danger" role=alert>Your browser does not support JavaScript.</div></noscript><div class=col-xxl-8><div class=container><nav class="row card component" aria-label=breadcrumb><div class="card-body pb-0"><ol class="hbs-breadcrumb breadcrumb flex-nowrap"><li class="breadcrumb-item text-surface"><a href=/>Home</a></li><li class="breadcrumb-item text-surface"><a href=/blog/>Blogs</a></li><li class="breadcrumb-item active">Data Lake Demo Using Change Data Capture (CDC) on AWS – Part 3 Implement Data Lake</li></ol></div></nav><div class="post-panel-wrapper position-relative d-flex justify-content-center"><div class="d-flex flex-row justify-content-center rounded rounded-5 border border-primary post-panel position-fixed px-3 py-1 surface shadow"><a class="action action-toc d-none d-xxl-block" href=#postTOC role=button title="Table of contents"><i class="fas fa-fw fa-list-alt"></i></a>
<a class="action action-toc d-block d-xxl-none" href=#post-toc-container role=button title="Table of contents"><i class="fas fa-fw fa-list-alt"></i></a>
<a class="action action-post-comments" href=#post-comments role=button aria-label=Comments title=Comments><i class="fas fa-fw fa-comments"></i></a>
<a id=sidebarToggler class="action action-sidebar-toggler d-none d-xxl-block" role=button title="Sidebar toggler"><i class="fas fa-fw fa-expand-alt" data-fa-transform=rotate-45></i></a></div></div><article class="row card component mb-4 post"><div class=card-header><h1 class="card-title post-title my-2">Data Lake Demo Using Change Data Capture (CDC) on AWS – Part 3 Implement Data Lake</h1></div><div class=card-body><div class="post-meta mb-3"><span class="post-date me-1 mb-1" title="created on 2021-12-19 00:00:00 +0000 UTC, updated on 2023-05-03 23:22:05 +0000 UTC.">December 19, 2021</span><span class="post-reading-time me-1 mb-1">11 min read</span><a href=/categories/change-data-capture-cdc/ class="btn btn-sm btn-secondary mb-1 me-2 py-0 pe-1 post-taxonomy post-taxonomy-sm post-category">
<i class="fas fa-fw fa-folder me-1"></i>Change Data Capture (CDC)</a><a href=/series/data-lake-demo-using-change-data-capture/ class="btn btn-sm btn-secondary mb-1 me-2 py-0 pe-1 post-taxonomy post-taxonomy-sm post-series">
<i class="fas fa-fw fa-columns me-1"></i>Data Lake Demo Using Change Data Capture</a><a href=/tags/amazon-emr/ class="btn btn-sm btn-secondary mb-1 me-2 py-0 pe-1 post-taxonomy post-taxonomy-sm post-tag">Amazon EMR</a><a href=/tags/amazon-msk/ class="btn btn-sm btn-secondary mb-1 me-2 py-0 pe-1 post-taxonomy post-taxonomy-sm post-tag">Amazon MSK</a><a href=/tags/amazon-msk-connect/ class="btn btn-sm btn-secondary mb-1 me-2 py-0 pe-1 post-taxonomy post-taxonomy-sm post-tag">Amazon MSK Connect</a><a href=/tags/apache-hudi/ class="btn btn-sm btn-secondary mb-1 me-2 py-0 pe-1 post-taxonomy post-taxonomy-sm post-tag">Apache Hudi</a><a href=/tags/apache-kafka/ class="btn btn-sm btn-secondary mb-1 me-2 py-0 pe-1 post-taxonomy post-taxonomy-sm post-tag">Apache Kafka</a><a href=/tags/apache-spark/ class="btn btn-sm btn-secondary mb-1 me-2 py-0 pe-1 post-taxonomy post-taxonomy-sm post-tag">Apache Spark</a><a href=/tags/aws/ class="btn btn-sm btn-secondary mb-1 me-2 py-0 pe-1 post-taxonomy post-taxonomy-sm post-tag">AWS</a><a href=/tags/change-data-capture/ class="btn btn-sm btn-secondary mb-1 me-2 py-0 pe-1 post-taxonomy post-taxonomy-sm post-tag">Change Data Capture</a><a href=/tags/data-lake/ class="btn btn-sm btn-secondary mb-1 me-2 py-0 pe-1 post-taxonomy post-taxonomy-sm post-tag">Data Lake</a><a href=/tags/docker/ class="btn btn-sm btn-secondary mb-1 me-2 py-0 pe-1 post-taxonomy post-taxonomy-sm post-tag">Docker</a><a href=/tags/terraform/ class="btn btn-sm btn-secondary mb-1 me-2 py-0 pe-1 post-taxonomy post-taxonomy-sm post-tag">Terraform</a></div><picture class="d-flex justify-content-center"><source srcset=/blog/2021-12-19-datalake-demo-part3/featured_hua25eccd3824300d3b1ed87f56797248c_164526_0x270_resize_box_3.png type=image/png media="(max-width: 576px)" width=588 height=270><img class="post-featured-img h-auto w-auto mb-3" alt="Data Lake Demo using Change Data Capture (CDC) on AWS – Part 3 Implement Data Lake" src=/blog/2021-12-19-datalake-demo-part3/featured_hua25eccd3824300d3b1ed87f56797248c_164526_0x480_resize_box_3.png width=1046 height=480 data-src=/blog/2021-12-19-datalake-demo-part3/featured.png></picture><div id=postTOC class="mb-3 text-surface"><h2 class=mb-3>Contents<a class="anchor ms-1" href=#postTOC></a></h2><nav id=TableOfContents><ul><li><a href=#architecture>Architecture</a></li><li><a href=#infrastructure>Infrastructure</a><ul><li><a href=#emr-cluster>EMR Cluster</a></li></ul></li><li><a href=#hudi-table>Hudi Table</a><ul><li><a href=#source-schema>Source Schema</a></li><li><a href=#deltastreamer>DeltaStreamer</a></li><li><a href=#emr-steps>EMR Steps</a></li><li><a href=#glue-table>Glue Table</a></li></ul></li><li><a href=#dashboard>Dashboard</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav><hr class=text-secondary></div><div class="post-content mb-3" data-bs-spy=scroll data-bs-target=#TableOfContents tabindex=0><div id=post-content-body><p><strong><a href=https://cevo.com.au/post/data-lake-demo-using-cdc-part-3/ target=_blank rel="noopener noreferrer">This article<i class="fas fa-external-link-square-alt ms-1"></i></a> was originally posted on Tech Insights of <a href=https://cevo.com.au/ target=_blank rel="noopener noreferrer">Cevo Australia<i class="fas fa-external-link-square-alt ms-1"></i></a>.</strong></p><p>In the <a href=/blog/2021-12-12-datalake-demo-part2>previous post</a>, we created a VPC that has private and public subnets in 2 availability zones in order to build and deploy the data lake solution on AWS. NAT instances are created to forward outbound traffic to the internet and a VPN bastion host is set up to facilitate deployment. An <a href=https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/Aurora.AuroraPostgreSQL.html target=_blank rel="noopener noreferrer">Aurora PostgreSQL<i class="fas fa-external-link-square-alt ms-1"></i></a> cluster is deployed to host the source database and a Python command line app is used to create the database. To develop data ingestion using CDC, an <a href=https://aws.amazon.com/msk/ target=_blank rel="noopener noreferrer">Amazon MSK<i class="fas fa-external-link-square-alt ms-1"></i></a> cluster is deployed and the <a href=https://debezium.io/documentation/reference/stable/connectors/postgresql.html target=_blank rel="noopener noreferrer">Debezium source<i class="fas fa-external-link-square-alt ms-1"></i></a> and <a href=https://lenses.io/blog/2020/11/new-kafka-to-S3-connector/ target=_blank rel="noopener noreferrer">Lenses S3 sink<i class="fas fa-external-link-square-alt ms-1"></i></a> connectors are created on <a href=https://aws.amazon.com/msk/features/msk-connect/ target=_blank rel="noopener noreferrer">MSK Connect<i class="fas fa-external-link-square-alt ms-1"></i></a>. We also confirmed the order creation and update events are captured as expected. As the last part of this series, we&rsquo;ll build an <a href=https://hudi.apache.org/docs/writing_data/#deltastreamer target=_blank rel="noopener noreferrer">Apache Hudi DeltaStreamer<i class="fas fa-external-link-square-alt ms-1"></i></a> app on <a href=https://aws.amazon.com/emr/ target=_blank rel="noopener noreferrer">Amazon EMR<i class="fas fa-external-link-square-alt ms-1"></i></a> and use the resulting Hudi table with <a href=https://aws.amazon.com/athena/ target=_blank rel="noopener noreferrer">Amazon Athena<i class="fas fa-external-link-square-alt ms-1"></i></a> and <a href=https://aws.amazon.com/quicksight/ target=_blank rel="noopener noreferrer">Amazon Quicksight<i class="fas fa-external-link-square-alt ms-1"></i></a> to build a dashboard.</p><ul><li><a href=/blog/2021-12-05-datalake-demo-part1>Part 1 Local Development</a></li><li><a href=/blog/2021-12-12-datalake-demo-part2>Part 2 Implement CDC</a></li><li><a href=/blog/2021-12-19-datalake-demo-part3/#>Part 3 Implement Data Lake</a> (this post)</li></ul><h2 id=architecture data-numberify>Architecture<a class="anchor ms-1" href=#architecture></a></h2><p>As described in a <a href=https://www.redhat.com/en/topics/integration/what-is-change-data-capture target=_blank rel="noopener noreferrer">Red Hat IT topics article<i class="fas fa-external-link-square-alt ms-1"></i></a>, <em>change data capture (CDC) is a proven data integration pattern to track when and what changes occur in data then alert other systems and services that must respond to those changes. Change data capture helps maintain consistency and functionality across all systems that rely on data</em>.</p><p>The primary use of CDC is to enable applications to respond almost immediately whenever data in databases change. Specifically its use cases cover microservices integration, data replication with up-to-date data, building time-sensitive analytics dashboards, auditing and compliance, cache invalidation, full-text search and so on. There are a number of approaches for CDC - polling, dual writes and log-based CDC. Among those, <a href=https://debezium.io/blog/2018/07/19/advantages-of-log-based-change-data-capture/ target=_blank rel="noopener noreferrer">log-based CDC has advantages<i class="fas fa-external-link-square-alt ms-1"></i></a> to other approaches.</p><p>Both <a href=https://docs.aws.amazon.com/dms/latest/userguide/CHAP_Task.CDC.html target=_blank rel="noopener noreferrer">Amazon DMS<i class="fas fa-external-link-square-alt ms-1"></i></a> and <a href=https://debezium.io/ target=_blank rel="noopener noreferrer">Debezium<i class="fas fa-external-link-square-alt ms-1"></i></a> implement log-based CDC. While the former is a managed service, the latter can be deployed to a Kafka cluster as a (source) connector. It uses <a href=https://www.redhat.com/en/topics/integration/what-is-apache-kafka target=_blank rel="noopener noreferrer">Apache Kafka<i class="fas fa-external-link-square-alt ms-1"></i></a> as a messaging service to deliver database change notifications to the applicable systems and applications. Note that Kafka Connect is a tool for streaming data between Apache Kafka and other data systems by connectors in a scalable and reliable way. In AWS, we can use <a href=https://aws.amazon.com/msk/ target=_blank rel="noopener noreferrer">Amazon MSK<i class="fas fa-external-link-square-alt ms-1"></i></a> and <a href=https://aws.amazon.com/msk/features/msk-connect/ target=_blank rel="noopener noreferrer">MSK Connect<i class="fas fa-external-link-square-alt ms-1"></i></a> for building a Debezium based CDC solution.</p><p>Data replication to data lakes using CDC can be much more effective if <a href=https://lakefs.io/hudi-iceberg-and-delta-lake-data-lake-table-formats-compared/ target=_blank rel="noopener noreferrer">data is stored to a format<i class="fas fa-external-link-square-alt ms-1"></i></a> that supports atomic transactions and consistent updates. Popular choices are <a href=https://hudi.apache.org/ target=_blank rel="noopener noreferrer">Apache Hudi<i class="fas fa-external-link-square-alt ms-1"></i></a>, <a href=https://iceberg.apache.org/ target=_blank rel="noopener noreferrer">Apache Iceberg<i class="fas fa-external-link-square-alt ms-1"></i></a> and <a href=https://delta.io/ target=_blank rel="noopener noreferrer">Delta Lake<i class="fas fa-external-link-square-alt ms-1"></i></a>. Among those, Apache Hudi can be a good option as it is <a href=https://docs.aws.amazon.com/emr/latest/ReleaseGuide/emr-hudi.html target=_blank rel="noopener noreferrer">well-integrated with AWS services<i class="fas fa-external-link-square-alt ms-1"></i></a>.</p><p>Below shows the architecture of the data lake solution that we will be building in this series of posts.</p><p><picture><img class="img-fluid mx-auto d-block" alt src=/blog/2021-12-19-datalake-demo-part3/00-01-architecture.png loading=lazy width=1301 height=535></picture></p><ol><li>Employing the <a href=https://microservices.io/patterns/data/transactional-outbox.html target=_blank rel="noopener noreferrer">transactional outbox pattern<i class="fas fa-external-link-square-alt ms-1"></i></a>, the source database publishes change event records to the CDC event table. The event records are generated by triggers that listen to insert and update events on source tables. See the Source Database section of the <a href=/blog/2021-12-05-datalake-demo-part1>first post of this series</a> for details.</li><li>CDC is implemented in a streaming environment and <a href=https://aws.amazon.com/msk/ target=_blank rel="noopener noreferrer">Amazon MSK<i class="fas fa-external-link-square-alt ms-1"></i></a> is used to build the streaming infrastructure. In order to process the real-time CDC event records, a source and sink connectors are set up in <a href=https://aws.amazon.com/msk/features/msk-connect/ target=_blank rel="noopener noreferrer">Amazon MSK Connect<i class="fas fa-external-link-square-alt ms-1"></i></a>. The <a href=https://debezium.io/documentation/reference/stable/connectors/postgresql.html target=_blank rel="noopener noreferrer">Debezium connector for PostgreSQL<i class="fas fa-external-link-square-alt ms-1"></i></a> is used as the source connector and the <a href=https://lenses.io/blog/2020/11/new-kafka-to-S3-connector/ target=_blank rel="noopener noreferrer">Lenses S3 connector<i class="fas fa-external-link-square-alt ms-1"></i></a> is used as the sink connector. The sink connector pushes messages to a S3 bucket.</li><li><a href=https://hudi.apache.org/docs/writing_data/#deltastreamer target=_blank rel="noopener noreferrer">Hudi DeltaStreamer<i class="fas fa-external-link-square-alt ms-1"></i></a> is run on <a href=https://aws.amazon.com/emr/ target=_blank rel="noopener noreferrer">Amazon EMR<i class="fas fa-external-link-square-alt ms-1"></i></a>. As a spark application, it reads files from the S3 bucket and upserts Hudi records to another S3 bucket. The Hudi table is created in the AWS Glue Data Catalog.</li><li>The Hudi table is queried in <a href=https://aws.amazon.com/athena/ target=_blank rel="noopener noreferrer">Amazon Athena<i class="fas fa-external-link-square-alt ms-1"></i></a> while the table is registered in the AWS Glue Data Catalog.</li><li>Dashboards are created in <a href=https://aws.amazon.com/quicksight/ target=_blank rel="noopener noreferrer">Amazon Quicksight<i class="fas fa-external-link-square-alt ms-1"></i></a> where the dataset is created using Amazon Athena.</li></ol><p>In this post, we&rsquo;ll build a Hudi DeltaStreamer app on Amazon EMR and use the resulting Hudi table with Athena and Quicksight to build a dashboard.</p><h2 id=infrastructure data-numberify>Infrastructure<a class="anchor ms-1" href=#infrastructure></a></h2><p>In the <a href=/blog/2021-12-12-datalake-demo-part2>previous post</a>, we created a VPC in the Sydney region, which has private and public subnets in 2 availability zones. We also created NAT instances in each availability zone to forward outbound traffic to the internet and a VPN bastion host to access resources in the private subnets. An EMR cluster will be deployed to one of the private subnets of the VPC.</p><h3 id=emr-cluster data-numberify>EMR Cluster<a class="anchor ms-1" href=#emr-cluster></a></h3><p>We&rsquo;ll create the EMR cluster with the following configurations.</p><ul><li>It is created with the latest EMR release - <em>semr-6.4.0</em>.</li><li>It has 1 master and 2 core instance groups - their instance types are <em>m4.large</em>.<ul><li>Both the instance groups have additional security groups that allow access from the VPN bastion host.</li></ul></li><li>It installs Hadoop, Hive, Spark, Presto, Hue and Livy.</li><li>It uses the AWS Glue Data Catalog as the metastore for Hive and Spark.</li></ul><p>The last configuration is important to register the Hudi table to the Glue Data Catalog so that it can be accessed from other AWS services such as Athena and Quicksight. The cluster is created by CloudFormation and the template also creates a Glue database (<em>datalake</em>) in which the Hudi table will be created. The template can be found in the project <a href=https://github.com/jaehyeon-kim/data-lake-demo/blob/main/infra/main/emr.yaml target=_blank rel="noopener noreferrer"><strong>GitHub repository</strong><i class="fas fa-external-link-square-alt ms-1"></i></a>.</p><p>Once the EMR cluster is ready, we can access the master instance as shown below. Note don&rsquo;t forget to connect the VPN bastion host using the SoftEther VPN client program.</p><p><picture><img class="img-fluid mx-auto d-block" alt src=/blog/2021-12-19-datalake-demo-part3/ssh-bastion.png loading=lazy width=721 height=449></picture></p><h2 id=hudi-table data-numberify>Hudi Table<a class="anchor ms-1" href=#hudi-table></a></h2><h3 id=source-schema data-numberify>Source Schema<a class="anchor ms-1" href=#source-schema></a></h3><p>Kafka only transfers data in byte format and data verification is not performed at the cluster level. As producers and consumers do not communicate with each other, we need a schema registry that sits outside a Kafka cluster and handles distribution of schemas. Although <a href=https://debezium.io/documentation/reference/stable/configuration/avro.html target=_blank rel="noopener noreferrer">it is recommended<i class="fas fa-external-link-square-alt ms-1"></i></a> to associate with a schema registry, we avoid using it because it requires either an <a href=https://docs.confluent.io/platform/current/schema-registry/index.html target=_blank rel="noopener noreferrer">external service<i class="fas fa-external-link-square-alt ms-1"></i></a> or a <a href=https://www.apicur.io/registry/ target=_blank rel="noopener noreferrer">custom server<i class="fas fa-external-link-square-alt ms-1"></i></a> to host a schema registry. Ideally it&rsquo;ll be good if we&rsquo;re able to use the <a href=https://docs.aws.amazon.com/glue/latest/dg/schema-registry.html target=_blank rel="noopener noreferrer">AWS Glue Schema Registry<i class="fas fa-external-link-square-alt ms-1"></i></a>, but unfortunately it doesn&rsquo;t support a REST interface and cannot be used at the moment.</p><p>In order to avoid having a schema registry, we use the built-in JSON converter (<code>org.apache.kafka.connect.json.JsonConverter</code>) as the key and value converters for the Debezium source and S3 sink connectors. The resulting value schema of our CDC event message is of the <em>struct</em> type, and it can be found in the project <a href=https://github.com/jaehyeon-kim/data-lake-demo/blob/main/hudi/note/schema-demo.datalake.cdc_events.json target=_blank rel="noopener noreferrer"><strong>GitHub repository</strong><i class="fas fa-external-link-square-alt ms-1"></i></a>. However, it is not supported by the DeltaStreamer utility that we&rsquo;ll be using to generate the Hudi table. A quick fix is replacing it with the Avro schema, and we can generate it with the local docker-compose environment that we discussed in the <a href=/blog/2021-12-05-datalake-demo-part1>first post of this series</a>. Once the local environment is up and running, we can create the Debezium source connector with the Avro converter (<code>io.confluent.connect.avro.AvroConverter</code>) as shown below.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>curl -i -X POST -H <span class=s2>&#34;Accept:application/json&#34;</span> -H  <span class=s2>&#34;Content-Type:application/json&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=ln>2</span><span class=cl><span class=se></span>  http://localhost:8083/connectors/ -d @connector/local/source-debezium-avro.json
</span></span></code></pre></div><p>Then we can download the value schema in the Schema tab of the topic.</p><p><picture><img class="img-fluid mx-auto d-block" alt src=/blog/2021-12-19-datalake-demo-part3/avro-schema.png loading=lazy width=1431 height=780></picture></p><p>The schema file of the CDC event messages can be found in the project <a href=https://github.com/jaehyeon-kim/data-lake-demo/blob/main/hudi/config/schema-msk.datalake.cdc_events.avsc target=_blank rel="noopener noreferrer"><strong>GitHub repository</strong><i class="fas fa-external-link-square-alt ms-1"></i></a>. Note that, although we use it as the source schema file for the DeltaStreamer app, we keep using the JSON converter for the Kafka connectors as we don&rsquo;t set up a schema registry</p><h3 id=deltastreamer data-numberify>DeltaStreamer<a class="anchor ms-1" href=#deltastreamer></a></h3><p>The <a href=https://hudi.apache.org/docs/writing_data#deltastreamer target=_blank rel="noopener noreferrer">HoodieDeltaStreamer<i class="fas fa-external-link-square-alt ms-1"></i></a> utility (part of hudi-utilities-bundle) provides the way to ingest from different sources such as DFS or Kafka, with the following capabilities.</p><ul><li><em>Exactly once ingestion of new events from Kafka, <a href=https://sqoop.apache.org/docs/1.4.2/SqoopUserGuide#_incremental_imports target=_blank rel="noopener noreferrer">incremental imports<i class="fas fa-external-link-square-alt ms-1"></i></a> from Sqoop or output of HiveIncrementalPuller or files under a DFS folder</em></li><li><em>Support JSON, AVRO or a custom record types for the incoming data</em></li><li><em>Manage checkpoints, rollback & recovery</em></li><li><em>Leverage AVRO schemas from DFS or Confluent <a href=https://github.com/confluentinc/schema-registry target=_blank rel="noopener noreferrer">schema registry<i class="fas fa-external-link-square-alt ms-1"></i></a>.</em></li><li><em>Support for plugging in transformations</em></li></ul><p>As shown below, it runs as a Spark application. Some important options are illustrated below.</p><ul><li>Hudi-related jar files are specified directly because Amazon EMR release version 5.28.0 and later installs Hudi components by default.<ul><li><a href=https://docs.aws.amazon.com/emr/latest/ReleaseGuide/emr-hudi.html target=_blank rel="noopener noreferrer">Hudi 0.8.0 is installed for EMR release 6.4.0<i class="fas fa-external-link-square-alt ms-1"></i></a>.</li></ul></li><li>It is deployed by the <a href=https://spark.apache.org/docs/latest/cluster-overview.html target=_blank rel="noopener noreferrer">cluster deploy mode<i class="fas fa-external-link-square-alt ms-1"></i></a> where the driver and executor have 2G and 4G of memory respectively.</li><li><a href=https://hudi.apache.org/learn/faq/#what-is-the-difference-between-copy-on-write-cow-vs-merge-on-read-mor-storage-types target=_blank rel="noopener noreferrer">Copy on Write (CoW)<i class="fas fa-external-link-square-alt ms-1"></i></a> is configured as the storage type.</li><li>Additional Hudi properties are saved in S3 (<code>cdc_events_deltastreamer_s3.properties</code>) - it&rsquo;ll be discussed below.</li><li>The JSON type is configured as the source file type - note we use the built-in JSON converter for the Kafka connectors.</li><li>The S3 target base path indicates the place where the Hudi data is stored, and the target table configures the resulting table.<ul><li>As we enable the AWS Glue Data Catalog as the Hive metastore, it can be accessed in Glue.</li></ul></li><li>The file-based schema provider is configured.<ul><li>The Avro schema file is referred to as the source schema file in the additional Hudi property file.</li></ul></li><li>Hive sync is enabled, and the minimum sync interval is set to 5 seconds.</li><li>It is set to run continuously and the <a href=https://hudi.apache.org/docs/writing_data/#write-operations target=_blank rel="noopener noreferrer">default UPSERT operation<i class="fas fa-external-link-square-alt ms-1"></i></a> is chosen.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln> 1</span><span class=cl>spark-submit --jars /usr/lib/spark/external/lib/spark-avro.jar,/usr/lib/hudi/hudi-utilities-bundle.jar <span class=se>\
</span></span></span><span class=line><span class=ln> 2</span><span class=cl><span class=se></span>    --master yarn <span class=se>\
</span></span></span><span class=line><span class=ln> 3</span><span class=cl><span class=se></span>    --deploy-mode cluster <span class=se>\
</span></span></span><span class=line><span class=ln> 4</span><span class=cl><span class=se></span>    --driver-memory 2g <span class=se>\
</span></span></span><span class=line><span class=ln> 5</span><span class=cl><span class=se></span>    --executor-memory 4g <span class=se>\
</span></span></span><span class=line><span class=ln> 6</span><span class=cl><span class=se></span>    --conf spark.sql.catalogImplementation<span class=o>=</span>hive <span class=se>\
</span></span></span><span class=line><span class=ln> 7</span><span class=cl><span class=se></span>    --conf spark.serializer<span class=o>=</span>org.apache.spark.serializer.KryoSerializer <span class=se>\
</span></span></span><span class=line><span class=ln> 8</span><span class=cl><span class=se></span>    --class org.apache.hudi.utilities.deltastreamer.HoodieDeltaStreamer /usr/lib/hudi/hudi-utilities-bundle.jar <span class=se>\
</span></span></span><span class=line><span class=ln> 9</span><span class=cl><span class=se></span>    --table-type COPY_ON_WRITE <span class=se>\
</span></span></span><span class=line><span class=ln>10</span><span class=cl><span class=se></span>    --source-ordering-field __source_ts_ms <span class=se>\
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=se></span>    --props <span class=s2>&#34;s3://data-lake-demo-cevo/hudi/config/cdc_events_deltastreamer_s3.properties&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=ln>12</span><span class=cl><span class=se></span>    --source-class org.apache.hudi.utilities.sources.JsonDFSSource <span class=se>\
</span></span></span><span class=line><span class=ln>13</span><span class=cl><span class=se></span>    --target-base-path <span class=s2>&#34;s3://data-lake-demo-cevo/hudi/cdc-events/&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=ln>14</span><span class=cl><span class=se></span>    --target-table datalake.cdc_events <span class=se>\
</span></span></span><span class=line><span class=ln>15</span><span class=cl><span class=se></span>    --schemaprovider-class org.apache.hudi.utilities.schema.FilebasedSchemaProvider <span class=se>\
</span></span></span><span class=line><span class=ln>16</span><span class=cl><span class=se></span>    --enable-sync <span class=se>\
</span></span></span><span class=line><span class=ln>17</span><span class=cl><span class=se></span>    --min-sync-interval-seconds <span class=m>5</span> <span class=se>\
</span></span></span><span class=line><span class=ln>18</span><span class=cl><span class=se></span>    --continuous <span class=se>\
</span></span></span><span class=line><span class=ln>19</span><span class=cl><span class=se></span>    --op UPSERT
</span></span></code></pre></div><p>Below shows the additional Hudi properties. For Hive sync, the database, table, partition fields and JDBC URL are specified. Note that the private IP address of the master instance is added to the host of the JDBC URL. It is required when submitting the application by the cluster deploy mode. By default, the host is set to localhost and the connection failure error will be thrown if the app doesn&rsquo;t run in the master. The remaining Hudi datasource properties are to configure the <a href=https://hudi.apache.org/blog/2021/02/13/hudi-key-generators/ target=_blank rel="noopener noreferrer">primary key of the Hudi table<i class="fas fa-external-link-square-alt ms-1"></i></a> - every record in Hudi is uniquely identified by a pair of record key and partition path fields. The Hudi DeltaStreamer properties specify the source schema file and the S3 location where the source data files exist. More details about the configurations can be found in the <a href=https://hudi.apache.org/docs/configurations/ target=_blank rel="noopener noreferrer">Hudi website<i class="fas fa-external-link-square-alt ms-1"></i></a>.</p><pre tabindex=0><code class=language-conf data-lang=conf># ./hudi/config/cdc_events_deltastreamer_s3.properties
## base properties
hoodie.upsert.shuffle.parallelism=2
hoodie.insert.shuffle.parallelism=2
hoodie.delete.shuffle.parallelism=2
hoodie.bulkinsert.shuffle.parallelism=2

## datasource properties
hoodie.datasource.hive_sync.database=datalake
hoodie.datasource.hive_sync.table=cdc_events
hoodie.datasource.hive_sync.partition_fields=customer_id,order_id
hoodie.datasource.hive_sync.partition_extractor_class=org.apache.hudi.hive.MultiPartKeysValueExtractor
hoodie.datasource.hive_sync.jdbcurl=jdbc:hive2://10.100.22.160:10000
hoodie.datasource.write.recordkey.field=order_id
hoodie.datasource.write.partitionpath.field=customer_id,order_id
hoodie.datasource.write.keygenerator.class=org.apache.hudi.keygen.ComplexKeyGenerator
hoodie.datasource.write.hive_style_partitioning=true
# only supported in Hudi 0.9.0+
# hoodie.datasource.write.drop.partition.columns=true

## deltastreamer properties
hoodie.deltastreamer.schemaprovider.source.schema.file=s3://data-lake-demo-cevo/hudi/config/schema-msk.datalake.cdc_events.avsc
hoodie.deltastreamer.source.dfs.root=s3://data-lake-demo-cevo/cdc-events/

## file properties
# 1,024 * 1,024 * 128 = 134,217,728 (128 MB)
hoodie.parquet.small.file.limit=134217728
</code></pre><h3 id=emr-steps data-numberify>EMR Steps<a class="anchor ms-1" href=#emr-steps></a></h3><p>While it is possible to submit the application in the master instance, it can also be submitted as an EMR step. As an example, a simple version of the app is submitted as shown below. The JSON file that configures the step can be found in the project <a href=https://github.com/jaehyeon-kim/data-lake-demo/blob/main/hudi/steps/cdc-events-simple.json target=_blank rel="noopener noreferrer"><strong>GitHub repository</strong><i class="fas fa-external-link-square-alt ms-1"></i></a>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>aws emr add-steps <span class=se>\
</span></span></span><span class=line><span class=ln>2</span><span class=cl><span class=se></span>  --cluster-id &lt;cluster-id&gt; <span class=se>\
</span></span></span><span class=line><span class=ln>3</span><span class=cl><span class=se></span>  --steps file://hudi/steps/cdc-events-simple.json
</span></span></code></pre></div><p>Once the step is added, we can see its details on the EMR console.</p><p><picture><img class="img-fluid mx-auto d-block" alt src=/blog/2021-12-19-datalake-demo-part3/steps.png loading=lazy width=1337 height=570></picture></p><h3 id=glue-table data-numberify>Glue Table<a class="anchor ms-1" href=#glue-table></a></h3><p>Below shows the Glue tables that are generated by the DeltaStreamer apps. The main table (<em>cdc_events</em>) is by submitting the app on the master instance while the simple version is by the EMR step.</p><p><picture><img class="img-fluid mx-auto d-block" alt src=/blog/2021-12-19-datalake-demo-part3/glue-tables-01.png loading=lazy width=859 height=166></picture></p><p>We can check the details of the table in Athena. When we run the describe query, it shows column and partition information. As expected, it has 2 partition columns and additional Hudi table meta information is included as extra columns.</p><p><picture><img class="img-fluid mx-auto d-block" alt src=/blog/2021-12-19-datalake-demo-part3/glue-tables-02.png loading=lazy width=524 height=650></picture></p><h2 id=dashboard data-numberify>Dashboard<a class="anchor ms-1" href=#dashboard></a></h2><p>Using the Glue table, we can create dashboards in Quicksight. As an example, a dataset of order items is created using Athena as illustrated in the <a href=https://docs.aws.amazon.com/quicksight/latest/user/create-a-data-set-athena.html target=_blank rel="noopener noreferrer">Quicksight documentation<i class="fas fa-external-link-square-alt ms-1"></i></a>. As the order items column in the source table is JSON, custom SQL is chosen so that it can be preprocessed in a more flexible way. The following SQL statement is used to create the dataset. First it parses the order items column and then flattens the array elements into rows. Also, the revenue column is added as a calculated field.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=ln> 1</span><span class=cl><span class=k>WITH</span><span class=w> </span><span class=n>raw_data</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=ln> 2</span><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w>
</span></span></span><span class=line><span class=ln> 3</span><span class=cl><span class=w>        </span><span class=n>customer_id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=ln> 4</span><span class=cl><span class=w>        </span><span class=n>order_id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=ln> 5</span><span class=cl><span class=w>        </span><span class=k>transform</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=ln> 6</span><span class=cl><span class=w>        </span><span class=k>CAST</span><span class=p>(</span><span class=n>json_parse</span><span class=p>(</span><span class=n>order_items</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=nb>ARRAY</span><span class=p>(</span><span class=k>MAP</span><span class=p>(</span><span class=nb>varchar</span><span class=p>,</span><span class=w> </span><span class=nb>varchar</span><span class=p>))),</span><span class=w>
</span></span></span><span class=line><span class=ln> 7</span><span class=cl><span class=w>        </span><span class=n>x</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=k>CAST</span><span class=p>(</span><span class=k>ROW</span><span class=p>(</span><span class=n>x</span><span class=p>[</span><span class=s1>&#39;discount&#39;</span><span class=p>],</span><span class=w> </span><span class=n>x</span><span class=p>[</span><span class=s1>&#39;quantity&#39;</span><span class=p>],</span><span class=w> </span><span class=n>x</span><span class=p>[</span><span class=s1>&#39;unit_price&#39;</span><span class=p>])</span><span class=w> 
</span></span></span><span class=line><span class=ln> 8</span><span class=cl><span class=w>                </span><span class=k>AS</span><span class=w> </span><span class=k>ROW</span><span class=p>(</span><span class=n>discount</span><span class=w> </span><span class=nb>decimal</span><span class=p>(</span><span class=mi>6</span><span class=p>,</span><span class=mi>2</span><span class=p>),</span><span class=w> </span><span class=n>quantity</span><span class=w> </span><span class=nb>decimal</span><span class=p>(</span><span class=mi>6</span><span class=p>,</span><span class=mi>2</span><span class=p>),</span><span class=w> </span><span class=n>unit_price</span><span class=w> </span><span class=nb>decimal</span><span class=p>(</span><span class=mi>6</span><span class=p>,</span><span class=mi>2</span><span class=p>)))</span><span class=w>
</span></span></span><span class=line><span class=ln> 9</span><span class=cl><span class=w>        </span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>order_items</span><span class=w>
</span></span></span><span class=line><span class=ln>10</span><span class=cl><span class=w>    </span><span class=k>from</span><span class=w> </span><span class=n>datalake</span><span class=p>.</span><span class=n>cdc_events</span><span class=w>
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=w></span><span class=p>),</span><span class=w> </span><span class=n>flat_data</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=ln>12</span><span class=cl><span class=w>	</span><span class=k>SELECT</span><span class=w> </span><span class=n>customer_id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=ln>13</span><span class=cl><span class=w>		  </span><span class=n>order_id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=ln>14</span><span class=cl><span class=w>		  </span><span class=n>item</span><span class=w>
</span></span></span><span class=line><span class=ln>15</span><span class=cl><span class=w>	</span><span class=k>FROM</span><span class=w> </span><span class=n>raw_data</span><span class=w>
</span></span></span><span class=line><span class=ln>16</span><span class=cl><span class=w>	</span><span class=k>CROSS</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=k>UNNEST</span><span class=p>(</span><span class=n>order_items</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>t</span><span class=p>(</span><span class=n>item</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=ln>17</span><span class=cl><span class=w></span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=ln>18</span><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=n>customer_id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=ln>19</span><span class=cl><span class=w>       </span><span class=n>order_id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=ln>20</span><span class=cl><span class=w>       </span><span class=n>item</span><span class=p>.</span><span class=n>discount</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=ln>21</span><span class=cl><span class=w>       </span><span class=n>item</span><span class=p>.</span><span class=n>quantity</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=ln>22</span><span class=cl><span class=w>       </span><span class=n>item</span><span class=p>.</span><span class=n>unit_price</span><span class=w>
</span></span></span><span class=line><span class=ln>23</span><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>flat_data</span><span class=w>
</span></span></span></code></pre></div><p>A demo dashboard is created using the order items dataset as shown below. The pie chart on the left indicates there are 3 big customers and the majority of revenue is earned by the top 20 customers. The scatter plot on the right shows a more interesting story. It marks the average quantity and revenue by customers and the dots are scaled by the number of orders - the more orders, the larger the size of the dot. While the 3 big customers occupy the top right area, 5 potentially profitable customers are identified. They do not purchase frequently but tend to buy expensive items, resulting in the average revenue being higher. We may investigate them further if a promotional event may be appropriate to make them purchase more frequently in the future.</p><p><picture><img class="img-fluid mx-auto d-block" alt src=/blog/2021-12-19-datalake-demo-part3/dashboard.png loading=lazy width=1489 height=577></picture></p><h2 id=conclusion data-numberify>Conclusion<a class="anchor ms-1" href=#conclusion></a></h2><p>In this post, we created an EMR cluster and developed a DeltaStreamer app that can be used to <em>upsert</em> records to a Hudi table. Being sourced as an Athena dataset, the records of the table are used by a Quicksight dashboard. Over the series of posts we have built an effective end-to-end data lake solution while combining various AWS services and open source tools. The source database is hosted in an Aurora PostgreSQL cluster and a change data capture (CDC) solution is built on Amazon MSK and MSK Connect. With the CDC output files in S3, a DeltaStreamer app is developed on Amazon EMR to build a Hudi table. The resulting table is used to create a dashboard with Amazon Athena and Quicksight.</p></div></div></div><div class=card-footer><div class="post-navs d-flex justify-content-evenly"><div class="post-nav post-prev"><i class="fas fa-fw fa-chevron-down post-prev-icon me-1" data-fa-transform=rotate-90></i>
<a href=/blog/2021-12-12-datalake-demo-part2/>Data Lake Demo Using Change Data Capture (CDC) on AWS – Part 2 Implement CDC</a></div><div class="post-nav post-next"><a href=/blog/2022-01-17-emr-on-eks-by-example/>EMR on EKS by Example</a>
<i class="fas fa-fw fa-chevron-down post-next-icon ms-1" data-fa-transform=rotate-270></i></div></div></div></article><section class="related-posts row card component"><div class=card-header><h2 class="card-title fs-4 my-2 text-surface">Related Posts</h2></div><div class="card-body slide px-1"><div class="slide-inner row gx-0"><div class="col-12 col-md-6 col-lg-4 me-2"><div class="post-card card card-body p-0 border-0 surface"><picture><source srcset=/blog/2021-12-12-datalake-demo-part2/featured_hua25eccd3824300d3b1ed87f56797248c_164526_500x0_resize_box_3.png media="(max-width: 576px)" height=229 width=500><img class=img-fluid height=83 width=180 alt=featured.png src=/blog/2021-12-12-datalake-demo-part2/featured_hua25eccd3824300d3b1ed87f56797248c_164526_180x0_resize_box_3.png data-src=/blog/2021-12-12-datalake-demo-part2/featured.png loading=lazy></picture>
<a class=post-title href=/blog/2021-12-12-datalake-demo-part2/>Data Lake Demo Using Change Data Capture (CDC) on AWS – Part 2 Implement CDC</a><div class="post-meta mb-0">December 12, 2021</div></div></div><div class="col-12 col-md-6 col-lg-4 me-2"><div class="post-card card card-body p-0 border-0 surface"><picture><source srcset=/blog/2021-12-05-datalake-demo-part1/featured_hua25eccd3824300d3b1ed87f56797248c_164526_500x0_resize_box_3.png media="(max-width: 576px)" height=229 width=500><img class=img-fluid height=83 width=180 alt=featured.png src=/blog/2021-12-05-datalake-demo-part1/featured_hua25eccd3824300d3b1ed87f56797248c_164526_180x0_resize_box_3.png data-src=/blog/2021-12-05-datalake-demo-part1/featured.png loading=lazy></picture>
<a class=post-title href=/blog/2021-12-05-datalake-demo-part1/>Data Lake Demo Using Change Data Capture (CDC) on AWS – Part 1 Local Development</a><div class="post-meta mb-0">December 5, 2021</div></div></div><div class="col-12 col-md-6 col-lg-4 me-2"><div class="post-card card card-body p-0 border-0 surface"><picture><source srcset=/blog/2021-11-14-glue-3-local-development/featured_hu689859cb443a98b1c98384fedaa00395_30923_500x0_resize_box_3.png media="(max-width: 576px)" height=296 width=500><img class=img-fluid height=107 width=180 alt=featured.png src=/blog/2021-11-14-glue-3-local-development/featured_hu689859cb443a98b1c98384fedaa00395_30923_180x0_resize_box_3.png data-src=/blog/2021-11-14-glue-3-local-development/featured.png loading=lazy></picture>
<a class=post-title href=/blog/2021-11-14-glue-3-local-development/>Local Development of AWS Glue 3.0 and Later</a><div class="post-meta mb-0">November 14, 2021</div></div></div><div class="col-12 col-md-6 col-lg-4 me-2"><div class="post-card card card-body p-0 border-0 surface"><picture><source srcset=/blog/2021-08-20-glue-local-development/featured_hu248b4052e45f408d4fe80445a9d59f15_19535_500x0_resize_box_3.png media="(max-width: 576px)" height=141 width=500><img class=img-fluid height=51 width=180 alt=featured.png src=/blog/2021-08-20-glue-local-development/featured_hu248b4052e45f408d4fe80445a9d59f15_19535_180x0_resize_box_3.png data-src=/blog/2021-08-20-glue-local-development/featured.png loading=lazy></picture>
<a class=post-title href=/blog/2021-08-20-glue-local-development/>AWS Glue Local Development With Docker and Visual Studio Code</a><div class="post-meta mb-0">August 20, 2021</div></div></div><div class="col-12 col-md-6 col-lg-4 me-2"><div class="post-card card card-body p-0 border-0 surface"><picture><source srcset=/blog/2020-04-13-airflow-lambda-operator/featured_hu1fb366ed8468cd95c289e8b53adf2b4c_44994_500x0_resize_box_3.png media="(max-width: 576px)" height=144 width=500><img class=img-fluid height=52 width=180 alt=featured.png src=/blog/2020-04-13-airflow-lambda-operator/featured_hu1fb366ed8468cd95c289e8b53adf2b4c_44994_180x0_resize_box_3.png data-src=/blog/2020-04-13-airflow-lambda-operator/featured.png loading=lazy></picture>
<a class=post-title href=/blog/2020-04-13-airflow-lambda-operator/>Thoughts on Apache Airflow AWS Lambda Operator</a><div class="post-meta mb-0">April 13, 2020</div></div></div><div class="col-12 col-md-6 col-lg-4 me-2"><div class="post-card card card-body p-0 border-0 surface"><picture><source srcset=/blog/2019-07-20-aws-localstack/featured_hu76363859e2b475a85e538ad8f869426e_164886_500x0_resize_box_3.png media="(max-width: 576px)" height=300 width=500><img class=img-fluid height=108 width=180 alt=featured.png src=/blog/2019-07-20-aws-localstack/featured_hu76363859e2b475a85e538ad8f869426e_164886_180x0_resize_box_3.png data-src=/blog/2019-07-20-aws-localstack/featured.png loading=lazy></picture>
<a class=post-title href=/blog/2019-07-20-aws-localstack/>AWS Local Development With LocalStack</a><div class="post-meta mb-0">July 20, 2019</div></div></div><div class="col-12 col-md-6 col-lg-4 me-2"><div class="post-card card card-body p-0 border-0 surface"><picture><source srcset=/blog/2019-11-29-traefik-example/featured_huf02131f0aec4656166a63d0e0c90fae1_139790_500x0_resize_box_3.png media="(max-width: 576px)" height=260 width=500><img class=img-fluid height=93 width=180 alt=featured.png src=/blog/2019-11-29-traefik-example/featured_huf02131f0aec4656166a63d0e0c90fae1_139790_180x0_resize_box_3.png data-src=/blog/2019-11-29-traefik-example/featured.png loading=lazy></picture>
<a class=post-title href=/blog/2019-11-29-traefik-example/>Dynamic Routing and Centralized Auth With Traefik, Python and R Example</a><div class="post-meta mb-0">November 29, 2019</div></div></div><div class="col-12 col-md-6 col-lg-4 me-2"><div class="post-card card card-body p-0 border-0 surface"><picture><source srcset=/blog/2019-11-15-task-queue/featured_hu7f23bb50744730950217f66f197f569b_51615_500x0_resize_box_3.png media="(max-width: 576px)" height=272 width=500><img class=img-fluid height=98 width=180 alt=featured.png src=/blog/2019-11-15-task-queue/featured_hu7f23bb50744730950217f66f197f569b_51615_180x0_resize_box_3.png data-src=/blog/2019-11-15-task-queue/featured.png loading=lazy></picture>
<a class=post-title href=/blog/2019-11-15-task-queue/>Distributed Task Queue With Python and R Example</a><div class="post-meta mb-0">November 15, 2019</div></div></div><div class="col-12 col-md-6 col-lg-4 me-2"><div class="post-card card card-body p-0 border-0 surface"><picture><source srcset=/blog/2019-11-01-linux-on-windows/featured_huc10c59749850e2c6e75df8112745c889_187978_500x0_resize_box_3.png media="(max-width: 576px)" height=271 width=500><img class=img-fluid height=98 width=180 alt=featured.png src=/blog/2019-11-01-linux-on-windows/featured_huc10c59749850e2c6e75df8112745c889_187978_180x0_resize_box_3.png data-src=/blog/2019-11-01-linux-on-windows/featured.png loading=lazy></picture>
<a class=post-title href=/blog/2019-11-01-linux-on-windows/>Linux Dev Environment on Windows</a><div class="post-meta mb-0">November 1, 2019</div></div></div><div class="col-12 col-md-6 col-lg-4 me-2"><div class="post-card card card-body p-0 border-0 surface"><picture><source srcset=/blog/2019-07-19-cronicle-multi-server-setup/featured_huf31defd43c31d7741cd0651b807bf58f_64396_500x0_resize_box_3.png media="(max-width: 576px)" height=305 width=500><img class=img-fluid height=110 width=180 alt=featured.png src=/blog/2019-07-19-cronicle-multi-server-setup/featured_huf31defd43c31d7741cd0651b807bf58f_64396_180x0_resize_box_3.png data-src=/blog/2019-07-19-cronicle-multi-server-setup/featured.png loading=lazy></picture>
<a class=post-title href=/blog/2019-07-19-cronicle-multi-server-setup/>Cronicle Multi Server Setup</a><div class="post-meta mb-0">July 19, 2019</div></div></div></div><button class=slide-control-left>
<i class="fas fa-2x fa-chevron-circle-down" data-fa-transform=rotate-90></i>
<span class=visually-hidden>Left</span></button>
<button class=slide-control-right>
<i class="fas fa-2x fa-chevron-circle-down" data-fa-transform=rotate-270></i>
<span class=visually-hidden>Right</span></button></div></section><div class="card component row post-comments" id=post-comments><div class=card-header><h2 class="card-title my-2 fs-4 text-surface">Comments</h2></div><div class=card-body><div class=giscus></div></div></div></div></div><aside class="col-xxl-4 sidebar d-flex"><div class="container d-flex flex-column"><div class="accordion profile"><div class="accordion-item card row text-center component"><div class="accordion-header card-header border-0" id=profile-header><a class="accordion-button d-lg-none mb-2 shadow-none p-0 bg-transparent text-surface" role=button data-bs-toggle=collapse href=#profile aria-expanded=true aria-controls=profile>Profile</a></div><div class="card-body collapse accordion-collapse accordion-body d-lg-block show" id=profile aria-labelledby=profile-header><div class="col-12 d-flex align-items-center justify-content-center"><picture><img class="profile-avatar rounded-circle" alt="Jaehyeon Kim" src=https://jaehyeon.me/images/profile.png loading=lazy data-viewer-invisible width=200 height=200></picture></div><div class="col-12 profile-meta"><div class="profile-name fw-fold fs-lg">Jaehyeon Kim</div><div class=profile-bio>Consultant at Cevo 🇦🇺 ▪️ ☁ AWS Community Builder ▪️ 💭 Blogger ▪️ 🚀 Real-time Enthusiast</div><a class="profile-about text-primary" href=/about/><i class="fas fa-fw fa-user"></i>About</a><a class="profile-contact text-primary" href=/contact/><i class="fas fa-fw fa-question-circle"></i>Contact Me</a></div><nav class="social-links nav justify-content-center mt-1 justify-content-around"><a class="nav-link social-link" href=mailto:dottami@gmail.com title=Email><i class="fas fa-fw fa-2x fa-envelope" style=color:#0963ac></i></a>
<a class="nav-link social-link" target=_blank href=https://github.com/jaehyeon-kim title=GitHub rel=me><i class="fa-fw fa-2x fab fa-github"></i></a>
<a class="nav-link social-link" target=_blank href=https://linkedin.com/in/jaehyeon-kim-76b93429 title=LinkedIn rel=me><i class="fa-fw fa-2x fab fa-linkedin-in" style=color:#0a66c2></i></a>
<a class="nav-link social-link" target=_blank href=https://www.paypal.com/paypalme/dottami title=PayPal rel=me><i class="fa-fw fa-2x fab fa-paypal"></i></a></nav></div></div></div><div class="accordion taxonomies-toggle"><div class="row card component accordion-item"><div class="accordion-header card-header border-0"><a class="accordion-button d-lg-none mb-1 shadow-none p-0 bg-transparent" role=button data-bs-toggle=collapse href=#taxonomies-toggle aria-expanded=true aria-controls=taxonomies-toggle>Taxonomies</a></div><div class="card-body collapse accordion-collapse accordion-body d-lg-block show" id=taxonomies-toggle><ul class="nav nav-pills nav-fill" role=tablist><li class=nav-item role=presentation><button class="nav-link active" id=taxonomyCategoriesTab data-bs-toggle=tab data-bs-target=#taxonomyCategories type=button role=tab aria-controls=taxonomyCategories aria-selected=true>
Categories</button></li><li class=nav-item role=presentation><button class=nav-link id=taxonomyTagsTab data-bs-toggle=tab data-bs-target=#taxonomyTags type=button role=tab aria-controls=taxonomyTags aria-selected=true>
Tags</button></li><li class=nav-item role=presentation><button class=nav-link id=taxonomySeriesTab data-bs-toggle=tab data-bs-target=#taxonomySeries type=button role=tab aria-controls=taxonomySeries aria-selected=true>
Series</button></li><li class=nav-item role=presentation><button class=nav-link id=taxonomyArchivesTab data-bs-toggle=tab data-bs-target=#taxonomyArchives type=button role=tab aria-controls=taxonomyArchives aria-selected=true>
Archives</button></li></ul><div class="tab-content mt-3"><div class="tab-pane active" id=taxonomyCategories role=tabpanel aria-labelledby=taxonomyCategoriesTab tabindex=0><a href=/categories/r/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-category me-2 mb-2" title=R>R
<span class="badge badge-sm text-secondary bg-white ms-1">15</span></a>
<a href=/categories/data-product/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-category me-2 mb-2" title="Data Product">Data Product
<span class="badge badge-sm text-secondary bg-white ms-1">11</span></a>
<a href=/categories/data-engineering/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-category me-2 mb-2" title="Data Engineering">Data Engineering
<span class="badge badge-sm text-secondary bg-white ms-1">7</span></a>
<a href=/categories/machine-learning/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-category me-2 mb-2" title="Machine Learning">Machine Learning
<span class="badge badge-sm text-secondary bg-white ms-1">7</span></a>
<a href=/categories/apache-kafka/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-category me-2 mb-2" title="Apache Kafka">Apache Kafka
<span class="badge badge-sm text-secondary bg-white ms-1">6</span></a>
<a href=/categories/data-build-tool-dbt/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-category me-2 mb-2" title="Data Build Tool (DBT)">Data Build Tool (DBT)
<span class="badge badge-sm text-secondary bg-white ms-1">5</span></a>
<a href=/categories/development/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-category me-2 mb-2" title=Development>Development
<span class="badge badge-sm text-secondary bg-white ms-1">5</span></a>
<a href=/categories/change-data-capture-cdc/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-category me-2 mb-2" title="Change Data Capture (CDC)">Change Data Capture (CDC)
<span class="badge badge-sm text-secondary bg-white ms-1">3</span></a>
<a href=/categories/engineering/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-category me-2 mb-2" title=Engineering>Engineering
<span class="badge badge-sm text-secondary bg-white ms-1">3</span></a>
<a href=/categories/general/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-category me-2 mb-2" title=General>General
<span class="badge badge-sm text-secondary bg-white ms-1">3</span></a>
<a href=/categories/apache-airflow/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-category me-2 mb-2" title="Apache Airflow">Apache Airflow
<span class="badge badge-sm text-secondary bg-white ms-1">2</span></a></div><div class=tab-pane id=taxonomyTags role=tabpanel aria-labelledby=taxonomyTagsTab tabindex=0><a href=/tags/r/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title=R>R
<span class="badge badge-sm text-secondary bg-white ms-1">36</span></a>
<a href=/tags/aws/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title=AWS>AWS
<span class="badge badge-sm text-secondary bg-white ms-1">28</span></a>
<a href=/tags/docker/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title=Docker>Docker
<span class="badge badge-sm text-secondary bg-white ms-1">18</span></a>
<a href=/tags/python/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title=Python>Python
<span class="badge badge-sm text-secondary bg-white ms-1">18</span></a>
<a href=/tags/apache-spark/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Apache Spark">Apache Spark
<span class="badge badge-sm text-secondary bg-white ms-1">16</span></a>
<a href=/tags/docker-compose/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Docker Compose">Docker Compose
<span class="badge badge-sm text-secondary bg-white ms-1">13</span></a>
<a href=/tags/terraform/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title=Terraform>Terraform
<span class="badge badge-sm text-secondary bg-white ms-1">13</span></a>
<a href=/tags/aws-lambda/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="AWS Lambda">AWS Lambda
<span class="badge badge-sm text-secondary bg-white ms-1">11</span></a>
<a href=/tags/amazon-emr/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Amazon EMR">Amazon EMR
<span class="badge badge-sm text-secondary bg-white ms-1">10</span></a>
<a href=/tags/apache-kafka/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Apache Kafka">Apache Kafka
<span class="badge badge-sm text-secondary bg-white ms-1">9</span></a>
<a href=/tags/amazon-msk/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Amazon MSK">Amazon MSK
<span class="badge badge-sm text-secondary bg-white ms-1">7</span></a>
<a href=/tags/amazon-msk-connect/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Amazon MSK Connect">Amazon MSK Connect
<span class="badge badge-sm text-secondary bg-white ms-1">5</span></a>
<a href=/tags/data-build-tool-dbt/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Data Build Tool (DBT)">Data Build Tool (DBT)
<span class="badge badge-sm text-secondary bg-white ms-1">5</span></a>
<a href=/tags/pyspark/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title=PySpark>PySpark
<span class="badge badge-sm text-secondary bg-white ms-1">5</span></a>
<a href=/tags/rserve/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title=Rserve>Rserve
<span class="badge badge-sm text-secondary bg-white ms-1">5</span></a>
<a href=/tags/visual-studio-code/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Visual Studio Code">Visual Studio Code
<span class="badge badge-sm text-secondary bg-white ms-1">5</span></a>
<a href=/tags/amazon-api-gateway/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Amazon API Gateway">Amazon API Gateway
<span class="badge badge-sm text-secondary bg-white ms-1">4</span></a>
<a href=/tags/amazon-quicksight/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Amazon QuickSight">Amazon QuickSight
<span class="badge badge-sm text-secondary bg-white ms-1">4</span></a>
<a href=/tags/kubernetes/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title=Kubernetes>Kubernetes
<span class="badge badge-sm text-secondary bg-white ms-1">4</span></a>
<a href=/tags/shiny/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title=Shiny>Shiny
<span class="badge badge-sm text-secondary bg-white ms-1">4</span></a>
<a href=/tags/amazon-eks/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Amazon EKS">Amazon EKS
<span class="badge badge-sm text-secondary bg-white ms-1">3</span></a>
<a href=/tags/apache-hudi/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Apache Hudi">Apache Hudi
<span class="badge badge-sm text-secondary bg-white ms-1">3</span></a>
<a href=/tags/aws-glue/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="AWS Glue">AWS Glue
<span class="badge badge-sm text-secondary bg-white ms-1">3</span></a>
<a href=/tags/aws-sam/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="AWS SAM">AWS SAM
<span class="badge badge-sm text-secondary bg-white ms-1">3</span></a>
<a href=/tags/change-data-capture/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Change Data Capture">Change Data Capture
<span class="badge badge-sm text-secondary bg-white ms-1">3</span></a>
<a href=/tags/data-lake/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Data Lake">Data Lake
<span class="badge badge-sm text-secondary bg-white ms-1">3</span></a>
<a href=/tags/fastapi/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title=FastAPI>FastAPI
<span class="badge badge-sm text-secondary bg-white ms-1">3</span></a>
<a href=/tags/sparkr/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title=SparkR>SparkR
<span class="badge badge-sm text-secondary bg-white ms-1">3</span></a>
<a href=/tags/amazon-athena/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Amazon Athena">Amazon Athena
<span class="badge badge-sm text-secondary bg-white ms-1">2</span></a>
<a href=/tags/amazon-eventbridge/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Amazon EventBridge">Amazon EventBridge
<span class="badge badge-sm text-secondary bg-white ms-1">2</span></a>
<a href=/tags/amazon-redshift/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Amazon Redshift">Amazon Redshift
<span class="badge badge-sm text-secondary bg-white ms-1">2</span></a>
<a href=/tags/apache-airflow/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Apache Airflow">Apache Airflow
<span class="badge badge-sm text-secondary bg-white ms-1">2</span></a>
<a href=/tags/javascript/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title=JavaScript>JavaScript
<span class="badge badge-sm text-secondary bg-white ms-1">2</span></a>
<a href=/tags/node.js/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title=Node.js>Node.js
<span class="badge badge-sm text-secondary bg-white ms-1">2</span></a>
<a href=/tags/plumber/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title=Plumber>Plumber
<span class="badge badge-sm text-secondary bg-white ms-1">2</span></a>
<a href=/tags/rapache/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title=rApache>rApache
<span class="badge badge-sm text-secondary bg-white ms-1">2</span></a>
<a href=/tags/amazon-ecs/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Amazon ECS">Amazon ECS
<span class="badge badge-sm text-secondary bg-white ms-1">1</span></a>
<a href=/tags/amazon-s3/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Amazon S3">Amazon S3
<span class="badge badge-sm text-secondary bg-white ms-1">1</span></a>
<a href=/tags/amazon-sqs/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Amazon SQS">Amazon SQS
<span class="badge badge-sm text-secondary bg-white ms-1">1</span></a>
<a href=/tags/apache-hive/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Apache Hive">Apache Hive
<span class="badge badge-sm text-secondary bg-white ms-1">1</span></a>
<a href=https://jaehyeon.me/tags class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title=ALL>ALL
<span class="badge badge-sm text-secondary bg-white ms-1">69</span></a></div><div class=tab-pane id=taxonomySeries role=tabpanel aria-labelledby=taxonomySeriesTab tabindex=0><a href=/series/tree-based-methods-in-r/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-series me-2 mb-2" title="Tree based methods in R">Tree based methods in R
<span class="badge badge-sm text-secondary bg-white ms-1">6</span></a>
<a href=/series/dbt-for-effective-data-transformation-on-aws/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-series me-2 mb-2" title="DBT for Effective Data Transformation on AWS">DBT for Effective Data Transformation on AWS
<span class="badge badge-sm text-secondary bg-white ms-1">5</span></a>
<a href=/series/serverless-data-product/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-series me-2 mb-2" title="Serverless Data Product">Serverless Data Product
<span class="badge badge-sm text-secondary bg-white ms-1">4</span></a>
<a href=/series/data-lake-demo-using-change-data-capture/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-series me-2 mb-2" title="Data Lake Demo Using Change Data Capture">Data Lake Demo Using Change Data Capture
<span class="badge badge-sm text-secondary bg-white ms-1">3</span></a>
<a href=/series/parallel-processing-on-single-machine/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-series me-2 mb-2" title="Parallel processing on single machine">Parallel processing on single machine
<span class="badge badge-sm text-secondary bg-white ms-1">3</span></a>
<a href=/series/api-development-with-r/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-series me-2 mb-2" title="API development with R">API development with R
<span class="badge badge-sm text-secondary bg-white ms-1">2</span></a>
<a href=/series/integrate-schema-registry-with-msk-connect/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-series me-2 mb-2" title="Integrate Schema Registry with MSK Connect">Integrate Schema Registry with MSK Connect
<span class="badge badge-sm text-secondary bg-white ms-1">2</span></a>
<a href=/series/simplify-streaming-ingestion-on-aws/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-series me-2 mb-2" title="Simplify Streaming Ingestion on AWS">Simplify Streaming Ingestion on AWS
<span class="badge badge-sm text-secondary bg-white ms-1">2</span></a>
<a href=/series/kafka-development-with-docker/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-series me-2 mb-2" title="Kafka Development with Docker">Kafka Development with Docker
<span class="badge badge-sm text-secondary bg-white ms-1">1</span></a></div><div class=tab-pane id=taxonomyArchives role=tabpanel aria-labelledby=taxonomyArchivesTab tabindex=0><a href class="btn btn-sm btn-secondary post-taxonomy ps-3 me-2 mb-2" title=2023>2023 <span class="badge badge-sm text-secondary bg-white ms-1">5</span></a>
<a href=/archives/2022/ class="btn btn-sm btn-secondary post-taxonomy ps-3 me-2 mb-2" title=2022>2022 <span class="badge badge-sm text-secondary bg-white ms-1">15</span></a>
<a href class="btn btn-sm btn-secondary post-taxonomy ps-3 me-2 mb-2" title=2021>2021 <span class="badge badge-sm text-secondary bg-white ms-1">7</span></a>
<a href class="btn btn-sm btn-secondary post-taxonomy ps-3 me-2 mb-2" title=2020>2020 <span class="badge badge-sm text-secondary bg-white ms-1">1</span></a>
<a href class="btn btn-sm btn-secondary post-taxonomy ps-3 me-2 mb-2" title=2019>2019 <span class="badge badge-sm text-secondary bg-white ms-1">5</span></a>
<a href class="btn btn-sm btn-secondary post-taxonomy ps-3 me-2 mb-2" title=2018>2018 <span class="badge badge-sm text-secondary bg-white ms-1">2</span></a>
<a href class="btn btn-sm btn-secondary post-taxonomy ps-3 me-2 mb-2" title=2017>2017 <span class="badge badge-sm text-secondary bg-white ms-1">6</span></a>
<a href class="btn btn-sm btn-secondary post-taxonomy ps-3 me-2 mb-2" title=2016>2016 <span class="badge badge-sm text-secondary bg-white ms-1">6</span></a>
<a href class="btn btn-sm btn-secondary post-taxonomy ps-3 me-2 mb-2" title=2015>2015 <span class="badge badge-sm text-secondary bg-white ms-1">15</span></a>
<a href class="btn btn-sm btn-secondary post-taxonomy ps-3 me-2 mb-2" title=2014>2014 <span class="badge badge-sm text-secondary bg-white ms-1">5</span></a></div></div></div></div></div><div class="accordion posts-toggle"><div class="row card component accordion-item"><div class="accordion-header card-header border-0"><a class="accordion-button d-lg-none mb-1 shadow-none p-0 bg-transparent" role=button data-bs-toggle=collapse href=#posts-toggle aria-expanded=true aria-controls=posts-toggle>Posts</a></div><div class="card-body collapse accordion-collapse accordion-body d-lg-block show" id=posts-toggle><ul class="nav nav-pills nav-fill" role=tablist><li class=nav-item role=presentation><button class="nav-link active" id=featured-posts-tab data-bs-toggle=tab data-bs-target=#featured-posts type=button role=tab aria-controls=featured-posts aria-selected=true>
Featured Posts</button></li><li class=nav-item role=presentation><button class=nav-link id=recent-posts-tab data-bs-toggle=tab data-bs-target=#recent-posts type=button role=tab aria-controls=recent-posts aria-selected=true>
Recent Posts</button></li></ul><div class="tab-content mt-3"><div class="tab-pane active" id=featured-posts role=tabpanel aria-labelledby=featured-posts-tab tabindex=0><ul class="post-list list-unstyled ms-1"><li class=mb-2><div class=d-flex><div class="flex-shrink-0 d-flex justify-content-center align-items-center" style=max-width:100px><picture><source srcset=/blog/2023-05-04-kafka-development-with-docker-part-1/featured_hu351ee075bb995e8f69034dc54fe8364b_98355_500x0_resize_box_3.png media="(max-width: 576px)" height=322 width=500><img class=img-fluid height=116 width=180 alt=featured.png src=/blog/2023-05-04-kafka-development-with-docker-part-1/featured_hu351ee075bb995e8f69034dc54fe8364b_98355_180x0_resize_box_3.png data-src=/blog/2023-05-04-kafka-development-with-docker-part-1/featured.png loading=lazy></picture></div><div class="flex-grow-1 d-flex flex-column h-auto justify-content-center ms-3"><a class=post-title href=/blog/2023-05-04-kafka-development-with-docker-part-1/>Kafka Development With Docker - Part 1 Kafka Cluster Setup</a><div class="post-meta mt-2"><span class=post-date>May 4, 2023</span></div></div></div></li><li class=mb-2><div class=d-flex><div class="flex-shrink-0 d-flex justify-content-center align-items-center" style=max-width:100px><picture><source srcset=/blog/2023-02-08-simplify-streaming-ingestion-redshift/featured_hu77abd5c8ed84cebc51bde5ecaefc7320_32864_500x0_resize_box_3.png media="(max-width: 576px)" height=239 width=500><img class=img-fluid height=86 width=180 alt=featured.png src=/blog/2023-02-08-simplify-streaming-ingestion-redshift/featured_hu77abd5c8ed84cebc51bde5ecaefc7320_32864_180x0_resize_box_3.png data-src=/blog/2023-02-08-simplify-streaming-ingestion-redshift/featured.png loading=lazy></picture></div><div class="flex-grow-1 d-flex flex-column h-auto justify-content-center ms-3"><a class=post-title href=/blog/2023-02-08-simplify-streaming-ingestion-redshift/>Simplify Streaming Ingestion on AWS – Part 1 MSK and Redshift</a><div class="post-meta mt-2"><span class=post-date>February 8, 2023</span></div></div></div></li><li class=mb-2><div class=d-flex><div class="flex-shrink-0 d-flex justify-content-center align-items-center" style=max-width:100px><picture><source srcset=/blog/2022-09-28-dbt-on-aws-part-1-redshift/featured_hu35d67be5daab492ffba00e48de3bbd29_97234_500x0_resize_box_3.png media="(max-width: 576px)" height=244 width=500><img class=img-fluid height=88 width=180 alt=featured.png src=/blog/2022-09-28-dbt-on-aws-part-1-redshift/featured_hu35d67be5daab492ffba00e48de3bbd29_97234_180x0_resize_box_3.png data-src=/blog/2022-09-28-dbt-on-aws-part-1-redshift/featured.png loading=lazy></picture></div><div class="flex-grow-1 d-flex flex-column h-auto justify-content-center ms-3"><a class=post-title href=/blog/2022-09-28-dbt-on-aws-part-1-redshift/>Data Build Tool (Dbt) for Effective Data Transformation on AWS – Part 1 Redshift</a><div class="post-meta mt-2"><span class=post-date>September 28, 2022</span></div></div></div></li><li class=mb-2><div class=d-flex><div class="flex-shrink-0 d-flex justify-content-center align-items-center" style=max-width:100px><picture><source srcset=/blog/2022-08-26-emr-on-eks-with-terraform/featured_hu0db6c869a471dd7000f2d35dcf0e8ab0_67936_500x0_resize_box_3.png media="(max-width: 576px)" height=186 width=500><img class=img-fluid height=67 width=180 alt=featured.png src=/blog/2022-08-26-emr-on-eks-with-terraform/featured_hu0db6c869a471dd7000f2d35dcf0e8ab0_67936_180x0_resize_box_3.png data-src=/blog/2022-08-26-emr-on-eks-with-terraform/featured.png loading=lazy></picture></div><div class="flex-grow-1 d-flex flex-column h-auto justify-content-center ms-3"><a class=post-title href=/blog/2022-08-26-emr-on-eks-with-terraform/>Manage EMR on EKS With Terraform</a><div class="post-meta mt-2"><span class=post-date>August 26, 2022</span></div></div></div></li><li class=mb-2><div class=d-flex><div class="flex-shrink-0 d-flex justify-content-center align-items-center" style=max-width:100px><picture><source srcset=/blog/2022-07-18-sam-for-data-professionals/featured_hu896f95b0db9041cf59826714af2f73f7_22838_500x0_resize_box_3.png media="(max-width: 576px)" height=194 width=500><img class=img-fluid height=70 width=180 alt=featured.png src=/blog/2022-07-18-sam-for-data-professionals/featured_hu896f95b0db9041cf59826714af2f73f7_22838_180x0_resize_box_3.png data-src=/blog/2022-07-18-sam-for-data-professionals/featured.png loading=lazy></picture></div><div class="flex-grow-1 d-flex flex-column h-auto justify-content-center ms-3"><a class=post-title href=/blog/2022-07-18-sam-for-data-professionals/>Serverless Application Model (SAM) for Data Professionals</a><div class="post-meta mt-2"><span class=post-date>July 18, 2022</span></div></div></div></li><li class=mb-2><div class=d-flex><div class="flex-shrink-0 d-flex justify-content-center align-items-center" style=max-width:100px><picture><source srcset=/blog/2022-05-08-emr-local-dev/featured_hu653aa93a98a5139fededca231658be70_25693_500x0_resize_box_3.png media="(max-width: 576px)" height=291 width=500><img class=img-fluid height=105 width=180 alt=featured.png src=/blog/2022-05-08-emr-local-dev/featured_hu653aa93a98a5139fededca231658be70_25693_180x0_resize_box_3.png data-src=/blog/2022-05-08-emr-local-dev/featured.png loading=lazy></picture></div><div class="flex-grow-1 d-flex flex-column h-auto justify-content-center ms-3"><a class=post-title href=/blog/2022-05-08-emr-local-dev/>Develop and Test Apache Spark Apps for EMR Locally Using Docker</a><div class="post-meta mt-2"><span class=post-date>May 8, 2022</span></div></div></div></li><li class=mb-2><div class=d-flex><div class="flex-shrink-0 d-flex justify-content-center align-items-center" style=max-width:100px><picture><source srcset=/blog/2021-12-05-datalake-demo-part1/featured_hua25eccd3824300d3b1ed87f56797248c_164526_500x0_resize_box_3.png media="(max-width: 576px)" height=229 width=500><img class=img-fluid height=83 width=180 alt=featured.png src=/blog/2021-12-05-datalake-demo-part1/featured_hua25eccd3824300d3b1ed87f56797248c_164526_180x0_resize_box_3.png data-src=/blog/2021-12-05-datalake-demo-part1/featured.png loading=lazy></picture></div><div class="flex-grow-1 d-flex flex-column h-auto justify-content-center ms-3"><a class=post-title href=/blog/2021-12-05-datalake-demo-part1/>Data Lake Demo Using Change Data Capture (CDC) on AWS – Part 1 Local Development</a><div class="post-meta mt-2"><span class=post-date>December 5, 2021</span></div></div></div></li></ul></div><div class=tab-pane id=recent-posts role=tabpanel aria-labelledby=recent-posts-tab tabindex=0><ul class="post-list list-unstyled ms-1"><li class=mb-2><div class=d-flex><div class="flex-shrink-0 d-flex justify-content-center align-items-center" style=max-width:100px><picture><source srcset=/blog/2023-05-04-kafka-development-with-docker-part-1/featured_hu351ee075bb995e8f69034dc54fe8364b_98355_500x0_resize_box_3.png media="(max-width: 576px)" height=322 width=500><img class=img-fluid height=116 width=180 alt=featured.png src=/blog/2023-05-04-kafka-development-with-docker-part-1/featured_hu351ee075bb995e8f69034dc54fe8364b_98355_180x0_resize_box_3.png data-src=/blog/2023-05-04-kafka-development-with-docker-part-1/featured.png loading=lazy></picture></div><div class="flex-grow-1 d-flex flex-column h-auto justify-content-center ms-3"><a class=post-title href=/blog/2023-05-04-kafka-development-with-docker-part-1/>Kafka Development With Docker - Part 1 Kafka Cluster Setup</a><div class="post-meta mt-2"><span class=post-date>May 4, 2023</span></div></div></div></li><li class=mb-2><div class=d-flex><div class="flex-shrink-0 d-flex justify-content-center align-items-center" style=max-width:100px><picture><source srcset=/blog/2023-04-24-self-hosted-blog/featured_hu1fddab158d55343a3c1c024afda22657_41850_500x0_resize_box_3.png media="(max-width: 576px)" height=240 width=500><img class=img-fluid height=86 width=180 alt=featured.png src=/blog/2023-04-24-self-hosted-blog/featured_hu1fddab158d55343a3c1c024afda22657_41850_180x0_resize_box_3.png data-src=/blog/2023-04-24-self-hosted-blog/featured.png loading=lazy></picture></div><div class="flex-grow-1 d-flex flex-column h-auto justify-content-center ms-3"><a class=post-title href=/blog/2023-04-24-self-hosted-blog/>Self-Managed Blog With Hugo and GitHub Pages</a><div class="post-meta mt-2"><span class=post-date>April 24, 2023</span></div></div></div></li><li class=mb-2><div class=d-flex><div class="flex-shrink-0 d-flex justify-content-center align-items-center" style=max-width:100px><picture><source srcset=/blog/2023-03-14-simplify-streaming-ingestion-athena/featured_huef6334952f8505bdd5ee5a48de258194_43403_500x0_resize_box_3.png media="(max-width: 576px)" height=258 width=500><img class=img-fluid height=93 width=180 alt=featured.png src=/blog/2023-03-14-simplify-streaming-ingestion-athena/featured_huef6334952f8505bdd5ee5a48de258194_43403_180x0_resize_box_3.png data-src=/blog/2023-03-14-simplify-streaming-ingestion-athena/featured.png loading=lazy></picture></div><div class="flex-grow-1 d-flex flex-column h-auto justify-content-center ms-3"><a class=post-title href=/blog/2023-03-14-simplify-streaming-ingestion-athena/>Simplify Streaming Ingestion on AWS – Part 2 MSK and Athena</a><div class="post-meta mt-2"><span class=post-date>March 14, 2023</span></div></div></div></li><li class=mb-2><div class=d-flex><div class="flex-shrink-0 d-flex justify-content-center align-items-center" style=max-width:100px><picture><source srcset=/blog/2023-02-08-simplify-streaming-ingestion-redshift/featured_hu77abd5c8ed84cebc51bde5ecaefc7320_32864_500x0_resize_box_3.png media="(max-width: 576px)" height=239 width=500><img class=img-fluid height=86 width=180 alt=featured.png src=/blog/2023-02-08-simplify-streaming-ingestion-redshift/featured_hu77abd5c8ed84cebc51bde5ecaefc7320_32864_180x0_resize_box_3.png data-src=/blog/2023-02-08-simplify-streaming-ingestion-redshift/featured.png loading=lazy></picture></div><div class="flex-grow-1 d-flex flex-column h-auto justify-content-center ms-3"><a class=post-title href=/blog/2023-02-08-simplify-streaming-ingestion-redshift/>Simplify Streaming Ingestion on AWS – Part 1 MSK and Redshift</a><div class="post-meta mt-2"><span class=post-date>February 8, 2023</span></div></div></div></li><li class=mb-2><div class=d-flex><div class="flex-shrink-0 d-flex justify-content-center align-items-center" style=max-width:100px><picture><source srcset=/blog/2023-01-10-kafka-consumer-seek-offsets/featured_hua222fe3eeaae92dfa98b24cdf7061694_47217_500x0_resize_box_3.png media="(max-width: 576px)" height=368 width=500><img class=img-fluid height=132 width=180 alt=featured.png src=/blog/2023-01-10-kafka-consumer-seek-offsets/featured_hua222fe3eeaae92dfa98b24cdf7061694_47217_180x0_resize_box_3.png data-src=/blog/2023-01-10-kafka-consumer-seek-offsets/featured.png loading=lazy></picture></div><div class="flex-grow-1 d-flex flex-column h-auto justify-content-center ms-3"><a class=post-title href=/blog/2023-01-10-kafka-consumer-seek-offsets/>How to Configure Kafka Consumers to Seek Offsets by Timestamp</a><div class="post-meta mt-2"><span class=post-date>January 10, 2023</span></div></div></div></li><li class=mb-2><div class=d-flex><div class="flex-shrink-0 d-flex justify-content-center align-items-center" style=max-width:100px><picture><source srcset=/blog/2022-12-06-dbt-on-aws-part-5-athena/featured_hu2cb992d854f23cc962e70e6949802760_91796_500x0_resize_box_3.png media="(max-width: 576px)" height=243 width=500><img class=img-fluid height=87 width=180 alt=featured.png src=/blog/2022-12-06-dbt-on-aws-part-5-athena/featured_hu2cb992d854f23cc962e70e6949802760_91796_180x0_resize_box_3.png data-src=/blog/2022-12-06-dbt-on-aws-part-5-athena/featured.png loading=lazy></picture></div><div class="flex-grow-1 d-flex flex-column h-auto justify-content-center ms-3"><a class=post-title href=/blog/2022-12-06-dbt-on-aws-part-5-athena/>Data Build Tool (Dbt) for Effective Data Transformation on AWS – Part 5 Athena</a><div class="post-meta mt-2"><span class=post-date>December 6, 2022</span></div></div></div></li><li class=mb-2><div class=d-flex><div class="flex-shrink-0 d-flex justify-content-center align-items-center" style=max-width:100px><picture><source srcset=/blog/2022-11-01-dbt-on-aws-part-4-emr-eks/featured_huad7bc56c3140ba61f8a863cb7496d5ad_91067_500x0_resize_box_3.png media="(max-width: 576px)" height=244 width=500><img class=img-fluid height=88 width=180 alt=featured.png src=/blog/2022-11-01-dbt-on-aws-part-4-emr-eks/featured_huad7bc56c3140ba61f8a863cb7496d5ad_91067_180x0_resize_box_3.png data-src=/blog/2022-11-01-dbt-on-aws-part-4-emr-eks/featured.png loading=lazy></picture></div><div class="flex-grow-1 d-flex flex-column h-auto justify-content-center ms-3"><a class=post-title href=/blog/2022-11-01-dbt-on-aws-part-4-emr-eks/>Data Build Tool (Dbt) for Effective Data Transformation on AWS – Part 4 EMR on EKS</a><div class="post-meta mt-2"><span class=post-date>November 1, 2022</span></div></div></div></li><li class=mb-2><div class=d-flex><div class="flex-shrink-0 d-flex justify-content-center align-items-center" style=max-width:100px><picture><source srcset=/blog/2022-10-19-dbt-on-aws-part-3-emr-ec2/featured_huad7bc56c3140ba61f8a863cb7496d5ad_91067_500x0_resize_box_3.png media="(max-width: 576px)" height=244 width=500><img class=img-fluid height=88 width=180 alt=featured.png src=/blog/2022-10-19-dbt-on-aws-part-3-emr-ec2/featured_huad7bc56c3140ba61f8a863cb7496d5ad_91067_180x0_resize_box_3.png data-src=/blog/2022-10-19-dbt-on-aws-part-3-emr-ec2/featured.png loading=lazy></picture></div><div class="flex-grow-1 d-flex flex-column h-auto justify-content-center ms-3"><a class=post-title href=/blog/2022-10-19-dbt-on-aws-part-3-emr-ec2/>Data Build Tool (Dbt) for Effective Data Transformation on AWS – Part 3 EMR on EC2</a><div class="post-meta mt-2"><span class=post-date>October 19, 2022</span></div></div></div></li><li class=mb-2><div class=d-flex><div class="flex-shrink-0 d-flex justify-content-center align-items-center" style=max-width:100px><picture><source srcset=/blog/2022-10-09-dbt-on-aws-part-2-glue/featured_hu1d701231f4bedda4f795cc28c9478fc5_90647_500x0_resize_box_3.png media="(max-width: 576px)" height=238 width=500><img class=img-fluid height=86 width=180 alt=featured.png src=/blog/2022-10-09-dbt-on-aws-part-2-glue/featured_hu1d701231f4bedda4f795cc28c9478fc5_90647_180x0_resize_box_3.png data-src=/blog/2022-10-09-dbt-on-aws-part-2-glue/featured.png loading=lazy></picture></div><div class="flex-grow-1 d-flex flex-column h-auto justify-content-center ms-3"><a class=post-title href=/blog/2022-10-09-dbt-on-aws-part-2-glue/>Data Build Tool (Dbt) for Effective Data Transformation on AWS – Part 2 Glue</a><div class="post-meta mt-2"><span class=post-date>October 9, 2022</span></div></div></div></li><li class=mb-2><div class=d-flex><div class="flex-shrink-0 d-flex justify-content-center align-items-center" style=max-width:100px><picture><source srcset=/blog/2022-09-28-dbt-on-aws-part-1-redshift/featured_hu35d67be5daab492ffba00e48de3bbd29_97234_500x0_resize_box_3.png media="(max-width: 576px)" height=244 width=500><img class=img-fluid height=88 width=180 alt=featured.png src=/blog/2022-09-28-dbt-on-aws-part-1-redshift/featured_hu35d67be5daab492ffba00e48de3bbd29_97234_180x0_resize_box_3.png data-src=/blog/2022-09-28-dbt-on-aws-part-1-redshift/featured.png loading=lazy></picture></div><div class="flex-grow-1 d-flex flex-column h-auto justify-content-center ms-3"><a class=post-title href=/blog/2022-09-28-dbt-on-aws-part-1-redshift/>Data Build Tool (Dbt) for Effective Data Transformation on AWS – Part 1 Redshift</a><div class="post-meta mt-2"><span class=post-date>September 28, 2022</span></div></div></div></li></ul></div></div></div></div></div></div></aside></div></main><footer class="footer mt-auto py-3 text-center container"><div class="offcanvas offcanvas-bottom h-auto" tabindex=-1 id=offcanvasActionsPanel aria-labelledby=offcanvasActionsPanelLabel><div class=offcanvas-header><div class="offcanvas-title h5" id=offcanvasActionsPanelLabel><i class="fas fa-fw fa-th-large me-1"></i>
Actions</div><button type=button class="btn-close ms-auto" data-bs-dismiss=offcanvas data-bs-target=offcanvasActionsPanel aria-label=Close></button></div><div class="offcanvas-body mt-2"><div class="actions d-flex overflow-auto align-items-center"><a role=button class="action action-go-back d-flex flex-column align-items-center me-3" href="javascript: window.history.back();"><span class="action-icon mb-2"><i class="fas fa-2x fa-chevron-circle-down" data-fa-transform=rotate-90></i></span> Go back</a>
<a role=button class="action action-reload-page d-flex flex-column align-items-center me-3"><span class="action-icon mb-2"><i class="fas fa-2x fa-redo-alt"></i></span> Reload</a>
<a role=button class="action action-copy-url d-flex flex-column align-items-center me-3"><span class="action-icon mb-2"><i class="fas fa-2x fa-link"></i></span> Copy URL</a></div></div></div><div class="row text-center"><div class="col-12 mt-2"><p class=mb-2>Jaehyeon Kim</p><p class="text-secondary mb-2"><small>Consultant at Cevo 🇦🇺 ▪️ ☁ AWS Community Builder ▪️ 💭 Blogger ▪️ 🚀 Real-time Enthusiast</small></p><div class="copyright mb-2 text-secondary"><small>Copyright © 2023-2023 Jaehyeon Kim. All Rights Reserved.</small></div><nav class="social-links nav justify-content-center mb-2 mt-3"><a class="nav-link social-link p-0 me-1 mb-2" target=_blank href=/index.xml title=RSS rel=me><i class="fas fa-fw fa-2x fa-rss" style=color:#ea6221></i></a></nav></div><div class="col-12 col-lg-8 offset-0 offset-lg-1"></div></div></footer><script data-precache src=/assets/main/bundle.min.973e2834c632824648b0a05f184bdd913ea7064eb1314b87c2ac9cc9891223a6.js integrity="sha256-lz4oNMYygkZIsKBfGEvdkT6nBk6xMUuHwqycyYkSI6Y=" crossorigin=anonymous async></script><script data-precache src=/assets/icons/bundle.min.4f30d5267a9f2f9d45ed93969d45ec626100a969a8b91f71f753315a261e9034.js integrity="sha256-TzDVJnqfL51F7ZOWnUXsYmEAqWmouR9x91MxWiYekDQ=" crossorigin=anonymous defer></script>
<script data-precache src=/assets/viewer/bundle.min.7f7e123a50432aec1a2b911aa055ea464134e1c29cbdd67ff0ec18fab6ab3335.js integrity="sha256-f34SOlBDKuwaK5EaoFXqRkE04cKcvdZ/8OwY+rarMzU=" crossorigin=anonymous defer></script>
<script data-precache defer src=/assets/katex/bundle.min.f2bed17e252bf9064f3762211c0c01ca20721553c300c0870497712bd9ae4b9d.js integrity="sha256-8r7RfiUr+QZPN2IhHAwByiByFVPDAMCHBJdxK9muS50=" crossorigin=anonymous></script>
<script data-precache defer src=/assets/mermaid/bundle.min.6ac89481082878c4db0f641e78a7c950995fe4d7978008551531a080754919ca.js integrity="sha256-asiUgQgoeMTbD2QeeKfJUJlf5NeXgAhVFTGggHVJGco=" crossorigin=anonymous></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-076N8WCGWZ"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-076N8WCGWZ",{anonymize_ip:!1})}</script><script>"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/service-worker.min.js").then(function(e){console.log("Successfully registered service worker",e)}).catch(function(e){console.warn("Error whilst registering service worker",e)})})</script><script src=https://giscus.app/client.js data-repo=jaehyeon-kim/jaehyeon-kim.github.io data-repo-id="MDEwOlJlcG9zaXRvcnkyNjgwMjU0NQ==" data-category data-category-id=DIC_kwDOAZj5cc4CV2fp data-mapping=pathname data-reactions-enabled=1 data-emit-metadata=1 data-input-position=bottom data-theme=preferred_color_scheme data-lang=en data-loading=lazy crossorigin=anonymous defer></script></body></html>